var BJ_REPORT=function(n){if(n.BJ_REPORT)return n.BJ_REPORT;var r=[],e={id:0,uin:0,url:"",combo:1,ext:{},level:4,ignore:[],random:1,delay:1e3,submit:null},t=function(n,r){return Object.prototype.toString.call(n)==="[object "+(r||"Object")+"]"},o=function(n){var r=typeof n;return"object"===r&&!!n},u=function(n){return null===n?!0:t(n,"Number")?!1:!n},i=n.onerror;n.onerror=function(r,e,o,u,a){var c=r;a&&a.stack&&(c=s(a)),t(c,"Event")&&(c+=c.type?"--"+c.type+"--"+(c.target?c.target.tagName+"::"+c.target.src:""):""),g.push({msg:c,target:e,rowNum:o,colNum:u}),v(),i&&i.apply(n,arguments)};var a=function(n){try{if(n.stack){var r=n.stack.match("https?://[^\n]+");r=r?r[0]:"";var e=r.match(":(\\d+):(\\d+)");e||(e=[0,0,0]);var t=s(n);return{msg:t,rowNum:e[1],colNum:e[2],target:r.replace(e[0],"")}}return n}catch(o){return n}},s=function(n){var r=n.stack.replace(/\n/gi,"").split(/\bat\b/).slice(0,5).join("@").replace(/\?[^:]+/gi,""),e=n.toString();return r.indexOf(e)<0&&(r=e+"@"+r),r},c=function(n,r){var t=[],i=[],a=[];if(o(n)){n.level=n.level||e.level;for(var s in n){var c=n[s];if(!u(c)){if(o(c))try{c=JSON.stringify(c)}catch(f){c="[BJ_REPORT detect value stringify error] "+f.toString()}a.push(s+":"+c),t.push(s+"="+encodeURIComponent(c)),i.push(s+"["+r+"]="+encodeURIComponent(c))}}}return[i.join("&"),a.join(","),t.join("&")]},f=[],l=function(n){if(e.submit)e.submit(n);else{var r=new Image;f.push(r),r.src=n}},p=[],m=0,v=function(n){if(e.report){for(;r.length;){var o=!1,u=r.shift(),i=c(u,p.length);if(t(e.ignore,"Array"))for(var a=0,s=e.ignore.length;s>a;a++){var f=e.ignore[a];if(t(f,"RegExp")&&f.test(i[1])||t(f,"Function")&&f(u,i[1])){o=!0;break}}o||(e.combo?p.push(i[0]):l(e.report+i[2]+"&_t="+ +new Date),e.onReport&&e.onReport(e.id,u))}var v=p.length;if(v){var g=function(){clearTimeout(m),l(e.report+p.join("&")+"&count="+v+"&_t="+ +new Date),m=0,p=[]};n?g():m||(m=setTimeout(g,e.delay))}}},g={push:function(n){return Math.random()>=e.random?g:(r.push(o(n)?a(n):{msg:n}),v(),g)},report:function(n){return n&&g.push(n),v(!0),g},info:function(n){return n?(o(n)?n.level=2:n={msg:n,level:2},g.push(n),g):g},debug:function(n){return n?(o(n)?n.level=1:n={msg:n,level:1},g.push(n),g):g},init:function(n){if(o(n))for(var r in n)e[r]=n[r];var t=parseInt(e.id,10);return t&&(e.report=(e.url||"http://badjs2.qq.com/badjs")+"?id="+t+"&uin="+parseInt(e.uin||(document.cookie.match(/\buin=\D+(\d+)/)||[])[1],10)+"&from="+encodeURIComponent(location.href)+"&ext="+JSON.stringify(e.ext)+"&"),g},__onerror__:n.onerror};return"undefined"!=typeof console&&console.error&&setTimeout(function(){var n=((location.hash||"").match(/([#&])BJ_ERROR=([^&$]+)/)||[])[2];n&&console.error("BJ_ERROR",decodeURIComponent(n).replace(/(:\d+:\d+)\s*/g,"$1\n"))},0),g}(window);"undefined"!=typeof exports&&("undefined"!=typeof module&&module.exports&&(exports=module.exports=BJ_REPORT),exports.BJ_REPORT=BJ_REPORT),function(n){if(n.BJ_REPORT){var r,e=function(r){n.BJ_REPORT.report(r)},t=n.BJ_REPORT.tryJs=function(n){return n&&(e=n),t},o=function(n,r){var e;for(e in r)n[e]=r[e]},u=function(n){return"function"==typeof n},i=function(t,o){return function(){try{return t.apply(this,o||arguments)}catch(u){if(e(u),u.stack&&console&&console.error&&console.error("[BJ-REPORT]",u.stack),!r){var i=n.onerror;n.onerror=function(){},r=setTimeout(function(){n.onerror=i,r=null},50)}throw u}}},a=function(n){return function(){for(var r,e=[],t=0,o=arguments.length;o>t;t++)r=arguments[t],u(r)&&(r=i(r)),e.push(r);return n.apply(this,e)}},s=function(n){return function(r,e){if("string"==typeof r)try{r=new Function(r)}catch(t){throw t}var o=[].slice.call(arguments,2);return r=i(r,o.length&&o),n(r,e)}},c=function(n,r){return function(){for(var e,t,o=[],a=0,s=arguments.length;s>a;a++)e=arguments[a],u(e)&&(t=i(e))&&(e.tryWrap=t)&&(e=t),o.push(e);return n.apply(r||this,o)}},f=function(n){var r,e;for(r in n)e=n[r],u(e)&&(n[r]=i(e));return n};t.spyJquery=function(){var r=n.$;if(!r||!r.event)return t;var e=r.event.add,o=r.ajax,i=r.event.remove;if(e&&(r.event.add=c(e),r.event.remove=function(){for(var n,r=[],e=0,t=arguments.length;t>e;e++)n=arguments[e],u(n)&&(n=n.tryWrap),r.push(n);return i.apply(this,r)}),o&&(r.ajax=function(n,e){return e||(e=n,n=void 0),f(e),n?o.call(r,n,e):o.call(r,e)}),$.zepto){var a=r.fn.on,s=r.fn.off;r.fn.on=c(a),r.fn.off=function(){for(var n,r=[],e=0,t=arguments.length;t>e;e++)n=arguments[e],u(n)&&(n=n.tryWrap),r.push(n);return s.apply(this,r)}}return t},t.spyModules=function(){var r=n.require,e=n.define;return e&&e.amd&&r&&(n.require=a(r),o(n.require,r),n.define=a(e),o(n.define,e)),n.seajs&&e&&(n.define=function(){for(var n,r=[],t=0,o=arguments.length;o>t;t++)n=arguments[t],u(n)&&(n=i(n),n.toString=function(n){return function(){return n.toString()}}(arguments[t])),r.push(n);return e.apply(this,r)},n.seajs.use=a(n.seajs.use),o(n.define,e)),t},t.spySystem=function(){return n.setTimeout=s(n.setTimeout),n.setInterval=s(n.setInterval),t},t.spyCustom=function(n){return u(n)?i(n):f(n)},t.spyAll=function(){return t.spyJquery().spyModules().spySystem(),t}}}(window);